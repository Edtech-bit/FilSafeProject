<div class="admin-wrap">
  <div class="admin-header">
    <h2>FilSafe Content Manager</h2>
    <div class="tab-toggle">
      <button [class.active]="currentTab === 'blog'" (click)="switchTab('blog')">Blogs</button>
      <button [class.active]="currentTab === 'product'" (click)="switchTab('product')">Products</button>
    </div>
  </div>

  <div *ngIf="currentTab === 'product'">
    <section class="admin-card">
      <form (ngSubmit)="onProductSubmit()">
        <div class="input-group"><label>Product Name</label><input type="text" [(ngModel)]="newProduct.name" name="pName" required></div>
        <div class="input-group">
          <label>Category</label>
          <select [(ngModel)]="newProduct.category" name="pCat">
            <option value="CCTV">CCTV Camera</option>
            <option value="Vault">Security Vault</option>
            <option value="Alarm">Alarm System</option>
          </select>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 10px;">
          <div class="input-group">
            <label>Product Image</label>
            <input type="file" (change)="onProductImageSelected($event)">
          </div>
          <div class="input-group">
            <label>Brochure Image</label>
            <input type="file" (change)="onBrochureSelected($event)">
          </div>
        </div>
        <button type="submit" class="btn-publish">Add Product</button>
      </form>
    </section>

    <section class="admin-card">
      <h3>Inventory ({{ products.length }} items)</h3>
      
      <div *ngIf="products.length > 0; else noData">
        <table class="admin-table">
          <thead>
            <tr><th>Name</th><th>Category</th><th>Action</th></tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of products">
              <td>
                <span class="clickable-name" (click)="openBrochurePopup(p.brochure)">
                  {{ p.name }} üëÅÔ∏è
                </span>
              </td>
              <td>{{ p.category }}</td>
              <td><button (click)="onDeleteProduct(p._id)" class="btn-delete">Remove</button></td>
            </tr>
          </tbody>
        </table>
      </div>

      <ng-template #noData>
        <p style="padding: 20px; text-align: center; color: #94a3b8;">
          No products found. If you have data in Atlas, wait a moment or check the console.
        </p>
      </ng-template>
    </section>
  </div>

  <div *ngIf="currentTab === 'blog'">
    <section class="admin-card">
      <table class="admin-table">
        <tr *ngFor="let blog of blogs">
          <td>{{ blog.title }}</td>
          <td><button (click)="onDeleteBlog(blog._id)" class="btn-delete">Delete</button></td>
        </tr>
      </table>
    </section>
  </div>

  <div class="modal-overlay" *ngIf="isModalOpen" (click)="closePopup()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closePopup()">&times;</button>
      <img [src]="selectedBrochure" alt="Brochure">
    </div>
  </div>
</div>